<div class="enterprise-dashboard">

  <aside class="sidebar" [class.collapsed]="isSidebarCollapsed">

    <div class="sidebar-header">
      <img src="assets/images/Opportunity-Slogan.png" alt="Enterprise Logo" class="dashboard-logo">
      <button class="collapse-btn" (click)="toggleSidebar()">
        <i class="fas fa-bars"></i>
      </button>
    </div>


    <nav class="sidebar-nav">
      <ul>



        <li class="nav-group">
          <div class="nav-group-title">Tender Management</div>
          <div class="dropdown-container">
            <a class="nav-link" (click)="toggleDropdown('tender')">
              <i class="fas fa-tasks"></i>
              <span>Tender Options</span>
              <i class="fas fa-caret-down dropdown-icon"></i>
            </a>
            <div class="dropdown-items" *ngIf="dropdownStates['tender']">
              <a routerLink="/tender-list" class="dropdown-item"><i class="fas fa-list"></i> Tender List</a>
              <a routerLink="/create-tender" class="dropdown-item"><i class="fas fa-plus-circle"></i> Create Tender</a>
              <a routerLink="/tender-details" class="dropdown-item"><i class="fas fa-file-alt"></i> Tender Details</a>
              <a routerLink="/publish-tender" class="dropdown-item"><i class="fas fa-bullhorn"></i> Publish Tender</a>

              <a routerLink="/sources" class="dropdown-item"><i class="fas fa-database"></i> Sources</a>
              <a routerLink="/locations" class="dropdown-item"><i class="fas fa-map-marker-alt"></i> Locations</a>
              <a routerLink="/categories" class="dropdown-item"><i class="fas fa-tags"></i> Categories</a>
            </div>
          </div>
        </li>



        <li class="nav-group">
          <div class="nav-group-title">Bid Management</div>
          <div class="dropdown-container">
            <a class="nav-link" (click)="toggleDropdown('bid')">
              <i class="fas fa-gavel"></i>
              <span>Bid Options</span>
              <i class="fas fa-caret-down dropdown-icon"></i>
            </a>
            <div class="dropdown-items" *ngIf="dropdownStates['bid']">
              <a routerLink="/submit-bid" class="dropdown-item"><i class="fas fa-file-upload"></i> Submit Bid</a>
              <a routerLink="/my-bids" class="dropdown-item"><i class="fas fa-folder-open"></i> My Bids</a>
              <a routerLink="/bid-details" class="dropdown-item"><i class="fas fa-search"></i> Bid Details</a>
              <a routerLink="/bid-list-admin" class="dropdown-item"><i class="fas fa-list-ol"></i> Bid List (Admin)</a>
            </div>
          </div>
        </li>


        <li class="nav-group">
          <div class="nav-group-title">Evaluation</div>
          <div class="dropdown-container">
            <a class="nav-link" (click)="toggleDropdown('evaluation')">
              <i class="fas fa-clipboard-check"></i>
              <span>Evaluation Options</span>
              <i class="fas fa-caret-down dropdown-icon"></i>
            </a>
            <div class="dropdown-items" *ngIf="dropdownStates['evaluation']">
              <a routerLink="/evaluate-bid" class="dropdown-item"><i class="fas fa-check-circle"></i> Evaluate Bid</a>
              <a routerLink="/evaluation-history" class="dropdown-item"><i class="fas fa-history"></i> Evaluation
                History</a>
              <a routerLink="/evaluation-logs" class="dropdown-item"><i class="fas fa-clipboard-list"></i> Evaluation
                Logs</a>
            </div>
          </div>
        </li>


        <li class="nav-group">
          <div class="nav-group-title">User Management</div>
          <div class="dropdown-container">
            <a class="nav-link" (click)="toggleDropdown('user')">
              <i class="fas fa-users-cog"></i>
              <span>User Options</span>
              <i class="fas fa-caret-down dropdown-icon"></i>
            </a>
            <div class="dropdown-items" *ngIf="dropdownStates['user']">
              <a routerLink="/user-list" class="dropdown-item"><i class="fas fa-users"></i> User List</a>
              <a routerLink="/create-user" class="dropdown-item"><i class="fas fa-user-plus"></i> Create User</a>
              <a routerLink="/edit-user" class="dropdown-item"><i class="fas fa-user-edit"></i> Edit User</a>
              <a routerLink="/user-roles" class="dropdown-item"><i class="fas fa-user-cog"></i> User Roles</a>
            </div>
          </div>
        </li>


        <li class="nav-group">
          <div class="nav-group-title">Reports</div>
          <div class="dropdown-container">
            <a class="nav-link" (click)="toggleDropdown('report')">
              <i class="fas fa-chart-bar"></i>
              <span>Report Options</span>
              <i class="fas fa-caret-down dropdown-icon"></i>
            </a>
            <div class="dropdown-items" *ngIf="dropdownStates['report']">
              <a routerLink="/workorder/123" class="dropdown-item">
                <i class="fas fa-briefcase"></i> Work Order
              </a>
              <a routerLink="/work-pogress" class="dropdown-item">
                <i class="fas fa-tasks"></i> Work Progress
              </a>
              <a routerLink="/work-report" class="dropdown-item">
                <i class="fas fa-file-alt"></i> Work Report
              </a>
            </div>
          </div>
        </li>



        <li class="nav-group">
          <div class="nav-group-title">Payments</div>
          <div class="dropdown-container">
            <a class="nav-link" (click)="toggleDropdown('payments')">
              <i class="fas fa-credit-card"></i>
              <span>Payment Options</span>
              <i class="fas fa-caret-down dropdown-icon"></i>
            </a>
            <div class="dropdown-items" *ngIf="dropdownStates['payments']">
              <a routerLink="/payment" class="dropdown-item">
                <i class="fas fa-wallet"></i> General Payment
              </a>
              <a routerLink="/tender-payment/123" class="dropdown-item">
                <i class="fas fa-file-invoice"></i> Tender Payment
              </a>
              <a routerLink="/work-payment" class="dropdown-item">
                <i class="fas fa-hand-holding-usd"></i> Work Payment
              </a>
            </div>
          </div>
        </li>

      </ul>
    </nav>


    <div class="sidebar-footer">
      <button class="btn btn-support">
        <i class="fas fa-life-ring"></i>
        <span>Enterprise Support</span>
      </button>
    </div>
  </aside>

  <main class="main-content" [class.expanded]="isSidebarCollapsed">

    <header>
      <div class="container header-container">
        <div class="logo">

          <h1>Tender<span>Pro</span></h1>
        </div>
        <nav id="nav">
          <ul>

            <li class="nav-item">
              <a routerLink="/admin-wallet" class="nav-link">
                <i class="fas fa-wallet"></i>
                <span>Admin Wallet</span>
              </a>
            </li>

            <li class="nav-item">
              <a routerLink="/final-report" class="nav-link">
                <i class="fas fa-wallet"></i>
                <span>reports</span>
              </a>
            </li>
            <a routerLink="/sources">Sources</a>
            <a routerLink="/locations">Locations</a>
            <a routerLink="/categories">Categories</a>
          </ul>
        </nav>
        <div class="mobile-menu" id="mobile-menu">
          <i class="fas fa-bars"></i>
        </div>
      </div>

    </header>




    <h2>Bid Evaluation</h2>

    <label for="tenderSelect">Select Tender:</label>
    <select #tenderSelect id="tenderSelect" (change)="onTenderChange(tenderSelect.value ? +tenderSelect.value : null)">
      <option [value]="null">-- Select Tender --</option>
      <option *ngFor="let tender of tenders" [value]="tender.id">
        {{ tender.title }}
      </option>
    </select>
    <div *ngIf="bids.length > 0" class="container my-4">
      <h3 class="mb-3 text-primary">All Bids</h3>
      <div class="row">
        <div class="col-md-4 mb-3" *ngFor="let bid of bids">
          <div class="card h-100 shadow-sm border-primary">
            <div class="card-body">
              <h5 class="card-title text-success">{{ bid.bidderName }}</h5>
              <p class="card-text">
                <strong>Amount:</strong> {{ bid.amount }} <br>
                <strong>Status:</strong>
                <span [ngClass]="{
              'text-success': bid.status === 'ACCEPTED',
              'text-danger': bid.status === 'REJECTED',
              'text-secondary': bid.status !== 'ACCEPTED' && bid.status !== 'REJECTED'
            }">{{ bid.status }}</span>
              </p>
              <button class="btn btn-success btn-sm me-2" (click)="acceptBid(bid.id!)"
                [disabled]="bid.status === 'ACCEPTED'">
                Accept
              </button>
              <button class="btn btn-danger btn-sm" (click)="rejectBid(bid.id!)" [disabled]="bid.status === 'REJECTED'">
                Reject
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>


    <div *ngIf="acceptedBids.length > 0" class="container my-4">
      <h3 class="mb-3 text-success">Accepted Bids</h3>
      <div class="table-responsive">
        <table class="table table-bordered table-striped table-hover align-middle">
          <thead class="table-success">
            <tr>
              <th>ID</th>
              <th>Bidder Name</th>
              <th>Email</th>
              <th>Contact Number</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let bid of acceptedBids">
              <td>{{ bid.id }}</td>
              <td>{{ bid.bidderName }}</td>
              <td>{{ bid.email }}</td>
              <td>{{ bid.contactNumber }}</td>
              <td>
                <button class="btn btn-primary btn-sm" (click)="createWorkOrder(bid.id)">
                  Create Work Order
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>



      <div *ngIf="rejectedBids.length > 0" class="container my-4">
        <h3 class="mb-3 text-danger">Rejected Bids</h3>
        <div class="table-responsive">
          <table class="table table-bordered table-hover align-middle">
            <thead class="table-danger">
              <tr>
                <th>ID</th>
                <th>Bidder Name</th>
                <th>Email</th>
                <th>Contact Number</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let bid of rejectedBids">
                <td>{{ bid.id }}</td>
                <td>{{ bid.bidderName }}</td>
                <td>{{ bid.email }}</td>
                <td>{{ bid.contactNumber }}</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>



      <footer class="enterprise-footer">

        <div class="footer-bottom">
          <p>&copy; 2025 Tender Management System. All rights reserved.</p>
          <div class="footer-links">
            <a href="#">Sitemap</a>
            <a href="#">Accessibility</a>
            <a href="#">System Requirements</a>
          </div>
        </div>
      </footer>